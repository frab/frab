// @nathanvda/cocoon@1.2.14 downloaded from https://ga.jspm.io/npm:@nathanvda/cocoon@1.2.14/cocoon.js

var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;(function(t){var n=0;var create_new_id=function(){return(new Date).getTime()+n++};var newcontent_braced=function(e){return"["+e+"]$1"};var newcontent_underscord=function(e){return"_"+e+"_$1"};var getInsertionNodeElem=function(e,n,a){if(!e)return a.parent();if("function"==typeof e){n&&console.warn("association-insertion-traversal is ignored, because association-insertion-node is given as a function.");return e(a)}return"string"==typeof e?n?a[n](e):"this"==e?a:t(e):void 0};t(document).on("click",".add_fields",(function(n){n.preventDefault();n.stopPropagation();var a=t(this||e),i=a.data("association"),o=a.data("associations"),r=a.data("association-insertion-template"),s=a.data("association-insertion-method")||a.data("association-insertion-position")||"before",c=a.data("association-insertion-node"),d=a.data("association-insertion-traversal"),l=parseInt(a.data("count"),10),f=new RegExp("\\[new_"+i+"\\](.*?\\s)","g"),u=new RegExp("_new_"+i+"_(\\w*)","g"),p=create_new_id(),v=r.replace(f,newcontent_braced(p)),g=[],h=n;if(v==r){f=new RegExp("\\[new_"+o+"\\](.*?\\s)","g");u=new RegExp("_new_"+o+"_(\\w*)","g");v=r.replace(f,newcontent_braced(p))}v=v.replace(u,newcontent_underscord(p));g=[v];l=isNaN(l)?1:Math.max(l,1);l-=1;while(l){p=create_new_id();v=r.replace(f,newcontent_braced(p));v=v.replace(u,newcontent_underscord(p));g.push(v);l-=1}var m=getInsertionNodeElem(c,d,a);m&&0!=m.length||console.warn("Couldn't find the element to insert the template. Make sure your `data-association-insertion-*` on `link_to_add_association` is correct.");t.each(g,(function(e,n){var a=t(n);var i=jQuery.Event("cocoon:before-insert");m.trigger(i,[a,h]);if(!i.isDefaultPrevented()){var o=m[s](a);m.trigger("cocoon:after-insert",[a,h])}}))}));t(document).on("click",".remove_fields.dynamic, .remove_fields.existing",(function(n){var a=t(this||e),i=a.data("wrapper-class")||"nested-fields",o=a.closest("."+i),r=o.parent(),s=n;n.preventDefault();n.stopPropagation();var c=jQuery.Event("cocoon:before-remove");r.trigger(c,[o,s]);if(!c.isDefaultPrevented()){var d=r.data("remove-timeout")||0;setTimeout((function(){if(a.hasClass("dynamic"))o.detach();else{a.prev("input[type=hidden]").val("1");o.hide()}r.trigger("cocoon:after-remove",[o,s])}),d)}}));t(document).on("ready page:load turbolinks:load",(function(){t(".remove_fields.existing.destroyed").each((function(n,a){var i=t(this||e),o=i.data("wrapper-class")||"nested-fields";i.closest("."+o).hide()}))}))})(jQuery);var t={};export default t;

