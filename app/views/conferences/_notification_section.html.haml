.bulk-notification
  %h5.card-title.mb-3
    - case state
    - when 'accepting'
      %i.bi.bi-check-circle.me-2.text-success
    - when 'rejecting'  
      %i.bi.bi-x-circle.me-2.text-danger
    - when 'confirmed'
      %i.bi.bi-calendar-check.me-2.text-info
    = t('notifications_module.n_events_in_state_x', count: e.count, state: t(state, scope: 'conferences_module'))
  
  - subscribers = e.map { |e| e.subscribers.count }.sum
  .mb-3
    %small.text-muted
      %i.bi.bi-people.me-1
      = t('notifications_module.n_subscribers', count: subscribers)

  - nospeakers = e.select { |e| e.speakers.count == 0 }
  - if nospeakers.count > 0
    .alert.alert-warning.alert-sm.mb-3
      %small
        %i.bi.bi-exclamation-triangle.me-1
        = t('notifications_module.warning_events_without_speakers', count: nospeakers.count)
        %ul.mb-0.mt-2
          - nospeakers.each do |e|
            %li= link_to e.title, e, class: 'text-decoration-none'

  .d-grid
    = button_to(t('notifications_module.send_notification_to_subscribers',
                  name: t(name, scope: 'notifications_module.notif'),
                  count: subscribers,
                  event: t('notifications_module.n_events', count: e.count) ),
                { action: 'send_notification', notification: state },
                { class: "btn #{'btn-success' if state == 'accepting'} #{'btn-danger' if state == 'rejecting'} #{'btn-info' if state == 'confirmed'}",
                  data: { controller: "confirm", action: "click->confirm#confirm", "confirm-message-value": t('notifications_module.send_notification_confirm',
                                      name: t(name, scope: 'notifications_module.notif'),
                                      count: e.count),
                          disable_with: t('work_in_progress') }})
