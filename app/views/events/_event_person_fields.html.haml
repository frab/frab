.nested-fields.card.mb-3{data: { controller: "person-filter", "person-filter-url-value": lookup_people_url }}
  .card-body
    .row.g-3
      .col-12.col-lg-6
        = f.input :person_filter, hint: t('people_module.inputs.hints.person_filter') do
          = text_field_tag :filter, '', class: 'form-control mb-2', data: { "person-filter-target": "filter" }
          .border.rounded.p-2.bg-light{data: { "person-filter-target": "display" }}
            - if f.object.person
              %strong= f.object.person.full_name_annotated
            - else
              %span.text-muted= t('none_selected', default: 'None selected')
          %div{style: "display: none;", data: { "person-filter-target": "selectContainer" }}
            = f.input_field :person_id, collection: [[f.object.person&.full_name_annotated, f.object.person_id]], class: 'form-select', size: 5, data: { "person-filter-target": "select" }
          = f.input_field :person_id, as: :hidden, data: { "person-filter-target": "hidden" }

      .col-12.col-md-6.col-lg-3
        = f.input :event_role, as: :select, collection: translated_options(EventPerson::ROLES) do
          = f.label :event_role
          = f.select :event_role, translated_options(EventPerson::ROLES), {}, { class: 'form-select' }
          .form-text
            = truncate(t('people_module.inputs.hints.event_role'), length: 100, separator: ' ')
            %button.btn.btn-link.btn-sm.p-0.ms-1{type: "button", data: { "bs-toggle": "collapse", "bs-target": "#eventRoleHint#{f.object.object_id}", aria_expanded: "false" }}
              = t('show_more', default: 'Show more')
            .collapse{id: "eventRoleHint#{f.object.object_id}"}
              = simple_format(t('people_module.inputs.hints.event_role'))

      .col-12.col-md-6.col-lg-3
        = f.input :role_state, as: :select, collection: translated_options(EventPerson::STATES)

      - if f.object.notification_subject.present? || f.object.notification_body.present?
        .col-12
          .row.g-3
            .col-12.col-md-6
              = f.input :notification_subject, label: t('people_module.inputs.notification_subject')
            .col-12
              = f.input :notification_body, label: t('people_module.inputs.notification_body'), as: :text, input_html: { rows: 3 }, hint: t('people_module.inputs.hints.notification_body', variables: Notification::VARIABLES.collect{ |key, desc| '%{'+key+'}' }.join(', '))

    .d-flex.justify-content-end.mt-3
      = remove_association_link :event_person, f
