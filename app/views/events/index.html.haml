%section
  .page-header
    .d-flex.flex-column.flex-md-row.justify-content-between.align-items-start.align-items-md-center.gap-3.mb-4
      .d-flex.flex-column
        %h1.mb-0
          = showing_my_events? ? t('events_module.my_events') : t('titles.event_list')
      .d-flex.flex-wrap.gap-2
        - if policy(@conference).manage?
          = action_button '<i class="bi bi-plus-circle"></i> '.html_safe + t('events_module.add_event'), new_event_path, hint: t('events_module.add_event_hint'), class: "btn btn-primary"
          - if @num_of_matching_events > 0
            = link_to '#', class: 'btn btn-secondary', data: { bs_toggle: "modal", bs_target: "#bulkEditModal" }, title: t('events_module.bulk_edit.show') do
              %i.bi.bi-stack
              %span.d-none.d-sm-inline.ms-1= t('events_module.bulk_edit.show')
            - if @conference.mail_templates.any?
              = link_to "#send_bulk_mail_form", class: 'btn btn-secondary', data: { controller: "toggle", "toggle-target-value": "#send_bulk_mail_form", action: "click->toggle#toggle" }, title: t('events_module.toggle_send_bulk_mail') do
                %i.bi.bi-envelope
                %span.d-none.d-sm-inline.ms-1= t('events_module.toggle_send_bulk_mail')
        - if policy(@conference).manage? and !showing_my_events?
          = action_button '<i class="bi bi-printer"></i> '.html_safe + t('events_module.print_cards'), cards_events_path(format: :pdf), hint: t('events_module.print_cards_hint'), class: "btn btn-secondary"
          = action_button '<i class="bi bi-printer"></i> '.html_safe + t('events_module.print_accepted_cards') , cards_events_path(accepted: true, format: :pdf), hint: t('events_module.print_accepted_cards_hint'), class: "btn btn-secondary"

  = render partial: "event_list_tabs"
  - unless @conference.events.any?
    .row
      .col-md-12
        .blank-slate
          %p= t('events_module.no_events') unless showing_my_events?
          %p= t('events_module.not_involved') if showing_my_events?
  - else
    = render partial: 'filters', locals: { params: params }

    - if policy(@conference).manage? and @conference.mail_templates.any? and @num_of_matching_events > 0
      #send_bulk_mail_form.card.mb-3{style: "display:none;"}
        .card-header
          %h6.mb-0
            %i.bi.bi-envelope.me-2
            = t('events_module.toggle_send_bulk_mail')
        .card-body
          = simple_form_for(:batch_actions, url: batch_actions_events_path(request.query_parameters), method: :post) do |f|
            .d-flex.align-items-center.gap-2
              = select_tag :template_name, options_for_select(@conference.mail_templates.pluck(:name)), include_blank: t('select_one'), class: "form-select", style: "width: 300px;"
              = f.button :submit, t('send'), name: 'bulk_email', id: 'bulk_email', data: { controller: "confirm", action: "click->confirm#confirm", "confirm-message-value": t('notifications_module.send_unspecified_notification_confirm', count: @num_of_matching_events) }, class: 'btn btn-primary'

    = render 'shared/search_and_table', collection: @events
    = render 'below_table'

  - if policy(@conference).manage? and @num_of_matching_events > 0
    #bulkEditModal.modal.fade{tabindex: "-1", "aria-hidden": "true"}
      .modal-dialog.modal-lg.modal-dialog-scrollable
        .modal-content
          = render partial: 'bulk_edit_modal'

  - filters_data.each do |filter|
    %div{id: "filterModal_#{filter.qname}", class: "modal fade", tabindex: "-1", "aria-hidden": "true"}
      .modal-dialog.modal-lg.modal-dialog-scrollable
        .modal-content
          = render partial: 'filter_modal', locals: { filter: filter }

